#!/bin/perl

# i3-clam-shell --- turn laptop display on/off with lid switch events

# Copyright (C) 2024 Daniel Hennigar

# Author: Daniel Hennigar

# This program is free software; you can redistribute it and/or modify
# it under the terms of either:

#   a) the Artistic License 2.0, or
#   b) the GNU General Public License as published by the Free Software
#      Foundation; either version 3, or (at your option) any later version.

# See the LICENSE file for more information.

use 5.032;
use strict;
use warnings;

# Set the appropriate command for i3 or sway
my $msg = "i3-msg";
if ( exists $ENV{"SWAYSOCK"} ) {
    $msg = "swaymsg";
}

# Get the current state of the laptop lid switch
open my $lid_state_file, '<', '/proc/acpi/button/lid/LID/state';
my $lid_state = <$lid_state_file>;
close $lid_state_file;

# Turn laptop display on/off based on lid switch state
if ( $lid_state =~ m/open/ ) {
    system("$msg output eDP-1 enable");
}
else {
    system("$msg output eDP-1 disable");
}
